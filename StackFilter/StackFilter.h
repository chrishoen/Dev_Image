#pragma once
/*==============================================================================
image stack filter
==============================================================================*/

//******************************************************************************
//******************************************************************************
//******************************************************************************

#include <string>
#include <opencv2/core/core.hpp>

#include "pxScriptReader.h"
#include "svImageEvaluator.h"
#include "svImageResults.h"

//******************************************************************************
//******************************************************************************
//******************************************************************************
// This class encalsulates an image stack filter. It reads from a script file
// to obtain the file paths of images contained in an image stack. It reads
// the stack of image files and filters them.
// reader to .

class StackFilter
{
public:

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Members:

   // Images.
   cv::Mat mInputImageD;
   cv::Mat mInputImageC;
   cv::Mat mInputImageU;
   cv::Mat mOutputImage;

   // Image file paths.
   std::string mInputPathD;
   std::string mInputPathC;
   std::string mInputPathU;
   std::string mOutputPath;

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Members.

   // Parameterized functions and variables.
   PX::ScriptReader   mReader;
   SV::ImageEvaluator mEvaluator;
   SV::ImageResults   mResults;

   // Metrics.
   int mReadCount;

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Methods.

   // Constructor.
   StackFilter();
   void reset();
   void show();

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Methods.

   // Filter the images pointed to by a script file. Return true if successful.
   bool doFilterScriptFile(std::string& aScriptFilePath);

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Methods.

   // Loop processing decomposition.
   void doBeforeLoop();
   void doProcessLoop();
   void doAfterLoop();
};

//******************************************************************************
//******************************************************************************
//******************************************************************************




